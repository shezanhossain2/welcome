---
- name: Generate
  hosts: sw
  connection: network_cli
  gather_facts: false
  
  collections:
    - community.network


  tasks:
    - name: Create a file new3_file.txt and push to GitHub
      block:
        - name: Show config
          community.network.exos_command:
            commands: show config
          register: config

        - name: SAVE OUTPUT TO ./backups/
          copy:
            content: "{{ config.stdout[0] }}"
            dest: "/tmp/{{ inventory_hostname }}.txt"
          delegate_to: localhost
          become: false

        - name: Check if 'create vlan IG' exists in the file
          shell: "grep -q 'create vlan IG' /path/to/your/file.txt"
          check_mode: true
          register: vlan_check_result
          ignore_errors: true  # Ignore errors if 'grep' doesn't find the line

        - name: Notify if 'create vlan IG' is found
          debug:
            msg: "Line 'create vlan IG' found in the file."
          when: vlan_check_result.rc == 0  # Check if 'grep' was successful (exit code 0)

